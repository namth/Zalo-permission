-- Migration 002: Migrate from user_profile to users table
-- NOTE: users table is now created in 001-init-schema.sql
-- This migration handles data migration and cleanup

-- Migrate data from user_profile to users (if any exists)
INSERT INTO users (zalo_id, name, phone, created_at, updated_at)
SELECT zalo_user_id, COALESCE(zalo_user_id, 'Unknown'), phone, created_at, updated_at
FROM user_profile
ON CONFLICT (zalo_id) DO NOTHING;

-- Optional: Drop old user_profile table (commented out for safety)
-- DROP TABLE IF EXISTS user_profile CASCADE;
